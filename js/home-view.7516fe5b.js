"use strict";(self["webpackChunkvue_front"]=self["webpackChunkvue_front"]||[]).push([[8],{6197:function(e,t,a){a.d(t,{Z:function(){return m}});var l=a(3396),i=a(7139),n=a(9242);const s={key:0,class:"app-input-caption"},o={class:"app-input-holder"},r=["value","type","disabled","placeholder","readonly","maxLength","min","max","step"];function u(e,t,a,u,c,p){return(0,l.wg)(),(0,l.iD)("div",{class:(0,i.C_)(["app-input",e.rootClasses])},[e.caption?((0,l.wg)(),(0,l.iD)("div",s,(0,i.zw)(e.caption),1)):(0,l.kq)("",!0),(0,l.WI)(e.$slots,"left"),(0,l._)("div",o,[(0,l._)("input",{class:"app-input-input",onFocus:t[0]||(t[0]=(...t)=>e.focusHandler&&e.focusHandler(...t)),onInput:t[1]||(t[1]=(...t)=>e.inputHandler&&e.inputHandler(...t)),onKeyup:[t[2]||(t[2]=(0,n.D2)(((...t)=>e.enterHandler&&e.enterHandler(...t)),["enter"])),t[3]||(t[3]=(0,n.D2)(((...t)=>e.escapeHandler&&e.escapeHandler(...t)),["escape"]))],value:e.localValue,type:e.type,disabled:e.disabled,placeholder:e.placeholder,readonly:e.readonly,maxLength:e.maxLength,min:e.min,max:e.max,step:e.step,spellcheck:"false",autocomplete:"off",ref:"input"},null,40,r),(0,l.WI)(e.$slots,"input-after")]),(0,l.Wm)(n.uT,{name:"clear"},{default:(0,l.w5)((()=>[e.clearable&&e.localValue?((0,l.wg)(),(0,l.iD)("span",{key:0,class:"app-input-clear",onClick:t[4]||(t[4]=t=>e.$emit("clear"))},"× ")):(0,l.kq)("",!0)])),_:1}),(0,l.WI)(e.$slots,"right")],2)}var c=(0,l.aZ)({name:"AppInput",props:{type:{type:String,default:"text"},modelValue:{type:[String,Number],default:""},value:{type:[String,Number],default:""},state:{type:String,default:""},validator:{type:Function},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},caption:{type:String},placeholder:{type:String},readonly:{type:Boolean,default:!1},maxLength:{type:Number},min:{type:[String,Number]},max:{type:[String,Number]},step:{type:[String,Number]}},emits:["update:modelValue","update:state","focus","clear","enter","blur","input","escape"],data(){return{localValue:this.modelValue||this.value,localState:this.state}},watch:{value(e,t){e!==t&&(this.setValue(e),this.validate())},modelValue(e,t){e!==t&&(this.setValue(e),this.validate())},state(e,t){e!==t&&this.setState(e)}},computed:{input(){return this.$refs.input},rootClasses(){return this.readonly||this.disabled?[]:[this.localState]}},methods:{enterHandler(e){"invalid"!==this.state&&(this.emitInputEvent("enter",e),this.blur())},inputHandler(e){const{value:t}=e.target;this.setValue(t),this.emitInputEvent("input",e)},focusHandler(e){this.validate(),this.emitInputEvent("focus",e)},escapeHandler(e){this.emitInputEvent("escape",e),this.blur()},emitInputEvent(e,t){const a=this.getInputEventData(),l={name:e,event:t,...a};this.$emit(e,l)},getInputEventData(){const e={value:this.localValue,state:this.localState};return e},validate(){if(this.validator){const{valid:e,message:t=""}=this.validator(this.localValue);this.setState(e?"valid":"invalid"),this.input.setCustomValidity(t),t&&this.input.reportValidity()}},setState(e){this.localState!==e&&(this.localState=e,this.$emit("update:state",e))},setValue(e){e="number"===this.type?Number(e):e,this.localValue!==e&&(this.localValue=e,this.$emit("update:modelValue",e))},focus(){try{this.input.focus()}catch(e){console.log(e)}},blur(){try{this.input.blur()}catch(e){console.log(e)}}}}),p=a(89);const d=(0,p.Z)(c,[["render",u]]);var m=d},7311:function(e,t,a){a.d(t,{Z:function(){return C}});var l=a(3396),i=a(7139),n=a(9242);const s={class:"app-select-input-head"},o=(0,l._)("div",{class:"app-select-arrow-vertical"},null,-1),r={class:"app-select-input-body"},u={key:0,class:"app-select-input-items custom-scroll"},c=["onClick"],p={key:1,class:"app-select-input-info"},d={key:0},m=(0,l._)("b",null,"Cкрыто:",-1),h={key:1},f=(0,l._)("b",null,"Всего:",-1);function g(e,t,a,g,v,y){const w=(0,l.up)("app-bar-loader"),b=(0,l.up)("app-input"),I=(0,l.Q2)("click-outside");return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:(0,i.C_)(["app-select-input",[e.mode,{open:e.open}]])},[(0,l._)("div",s,[(0,l.WI)(e.$slots,"head",{item:e.itemLocal,headClickHandler:e.headClickHandler},(()=>[(0,l.Wm)(b,{onFocus:e.focusHandler,onInput:e.inputHandler,onEscape:t[0]||(t[0]=t=>e.toggle(!1)),caption:e.caption,value:e.itemLocal.text,placeholder:e.placeholder},(0,l.Nv)({_:2},[e.dropArrow?{name:"input-after",fn:(0,l.w5)((()=>[o,e.loading?((0,l.wg)(),(0,l.j4)(w,{key:0})):(0,l.kq)("",!0)]))}:void 0]),1032,["onFocus","onInput","caption","value","placeholder"])])),(0,l.WI)(e.$slots,"head-right",{item:e.itemLocal})]),(0,l._)("div",r,[(0,l.Wm)(n.W3,{name:"select"},{default:(0,l.w5)((()=>[e.open&&e.itemsComputed.length?((0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.itemsComputed,((t,a)=>(0,l.WI)(e.$slots,"body",{key:a,item:t,index:a,itemClickHandler:e.itemClickHandler},(()=>[(0,l._)("div",{class:"app-select-input-item",onClick:a=>e.itemClickHandler(t)},[(0,l._)("span",null,(0,i.zw)(t.text),1),(0,l.WI)(e.$slots,"item-right",{item:t})],8,c)])))),128))])):(0,l.kq)("",!0),e.open&&e.footer&&!e.loading?((0,l.wg)(),(0,l.iD)("div",p,[e.limit?((0,l.wg)(),(0,l.iD)("span",d,[m,(0,l.Uk)(" "+(0,i.zw)(e.itemsLocal.length-e.itemsComputed.length)+" шт.",1)])):((0,l.wg)(),(0,l.iD)("span",h,[f,(0,l.Uk)(" "+(0,i.zw)(e.itemsLocal.length)+" шт.",1)]))])):(0,l.kq)("",!0)])),_:3})])],2)),[[I,()=>e.toggle(!1)]])}a(1703);var v=a(6197);function y(e,t=50,a={}){let l;const i=a.isImmediate??!1,n=a.callback??!1,s=a.maxWait;let o=Date.now(),r=[];function u(){if(void 0!==s){const e=Date.now()-o;if(e+t>=s)return s-e}return t}const c=function(...t){const a=this;return new Promise(((s,c)=>{const p=function(){if(l=void 0,o=Date.now(),!i){const l=e.apply(a,t);n&&n(l),r.forEach((({resolve:e})=>e(l))),r=[]}},d=i&&void 0===l;if(void 0!==l&&clearTimeout(l),l=setTimeout(p,u()),d){const l=e.apply(a,t);return n&&n(l),s(l)}r.push({resolve:s,reject:c})}))};return c.cancel=function(e){void 0!==l&&clearTimeout(l),r.forEach((({reject:t})=>t(e))),r=[]},c}var w=(0,l.aZ)({name:"AppSelectInput",components:{AppInput:v.Z},props:{caption:{type:String},modelValue:{type:Object,default:()=>({text:""})},items:{type:[Array,Function],default:()=>[]},limit:{type:Number,default:0,validator:e=>"number"===typeof e},itemsGetter:{type:Function},mode:{type:String,default:"search"},footer:{type:Boolean,default:!1},placeholder:{type:String,default:"Choose"},dropArrow:{type:Boolean,default:!0}},emits:["update:modelValue","changed","selected"],data(){return{itemLocal:this.modelValue,itemsLocal:[],searchKey:"",open:!1,loading:!1,loadItemsDebounced:void 0}},watch:{modelValue:{handler(e){this.itemLocal!==e&&(this.itemLocal=e)},immediate:!0},items:{handler(e){Array.isArray(e)?this.itemsLocal=[...e]:"function"===typeof e&&(this.loadItemsDebounced=y(e,1e3))},immediate:!0}},computed:{itemsComputed(){const e=Number(this.limit)||this.itemsLocal.length;let t=[];if("select"===this.mode)t=this.itemsLocal;else if("search"===this.mode){const e=this.searchKey.toLowerCase();t=this.itemsLocal.filter((t=>String(t.text).toLowerCase().includes(e))),t.sort(((t,a)=>{const l=String(t.text).toLowerCase().startsWith(e),i=String(a.text).toLowerCase().startsWith(e);return l&&i?0:l?-1:1}))}return t.slice(0,e)}},methods:{headClickHandler(){this.$slots.head&&(this.open?this.toggle(!1):(this.toggle(!0),this.loadItems()))},focusHandler(e){if("select"===this.mode){const t=e.event;t.target&&t.target.blur(),this.toggle()}else"search"===this.mode&&(this.searchKey=String(e.value),this.open||this.toggle(!0));this.loadItems()},inputHandler(e){this.searchKey=String(e.value),this.loadItems()},itemClickHandler(e){this.setItem(e)},async loadItems(e){try{if(this.isLoadNeeded(this.items)){const{value:t=this.searchKey,limit:a=this.limit}=e||{};if(!this.loadItemsDebounced)throw new Error("noLoadItemsDebounced");this.itemsLocal.length=0,this.loading=!0;const l=await this.loadItemsDebounced({value:t,limit:a});this.loading=!1,this.itemsLocal=[...l]}}catch(t){if(this.loading=!1,!t)return;throw t}},isLoadNeeded(e){return"function"===typeof this.items},setItem(e){const t=this.itemsComputed.findIndex((t=>t===e));this.$emit("selected",{item:e,index:t}),this.itemLocal!==e&&(this.itemLocal=e,this.$emit("update:modelValue",e),this.$emit("changed",{item:e,index:t})),this.toggle(!1)},toggle(e){this.open="boolean"===typeof e?e:!this.open,this.open||(this.loadItemsDebounced&&this.loadItemsDebounced.cancel(),this.loading=!1)}}}),b=a(89);const I=(0,b.Z)(w,[["render",g]]);var C=I},7637:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});var l=a(3396);const i={class:"home-view"};function n(e,t,a,n,s,o){const r=(0,l.up)("test");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(r)])}const s=(0,l._)("br",null,null,-1),o=(0,l._)("br",null,null,-1),r=(0,l._)("br",null,null,-1),u=(0,l._)("br",null,null,-1),c=(0,l._)("br",null,null,-1),p=(0,l._)("br",null,null,-1),d=(0,l._)("br",null,null,-1),m=(0,l._)("br",null,null,-1);function h(e,t,a,i,n,h){const f=(0,l.up)("app-button"),g=(0,l.up)("app-input"),v=(0,l.up)("app-select-input");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(g,{caption:"app-input",modelValue:e.inputValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.inputValue=t),clearable:"",onClear:t[1]||(t[1]=t=>e.inputValue=""),validator:e.inputValidator},{left:(0,l.w5)((()=>[(0,l.Wm)(f,{icon:"home"})])),_:1},8,["modelValue","validator"]),s,o,(0,l.Wm)(v,{caption:"app-select-input (search)",items:e.getAppSelectInputItems,mode:"search",footer:""},null,8,["items"]),r,u,(0,l.Wm)(v,{caption:"app-select-input (select)",items:e.appSelectInputItems,mode:"select",footer:""},null,8,["items"]),c,p,(0,l.Wm)(f,{class:"text-center",text:"Info modal",icon:"eye","collapse-at":"640",onClick:e.showInfoModal},null,8,["onClick"]),d,m,(0,l.Wm)(f,{class:"text-center",text:"Calendar modal",icon:"eye","collapse-at":"640",onClick:e.showCalendarModal},null,8,["onClick"])],64)}var f=a(7053),g=a(7311),v=a(6197),y=(0,l.aZ)({name:"Test",components:{AppSelectInput:g.Z,AppInput:v.Z},setup(){const{showModal:e}=f.Z;return{showModal:e}},data(){return{appSelectInputItems:[{text:"one"},{text:"two"},{text:"three"},{text:"four"}],inputValue:""}},methods:{async getAppSelectInputItems(e){const{value:t}=e,a=this.appSelectInputItems;return new Promise(((e,l)=>{setTimeout((()=>{const l=a.filter((e=>e.text.includes(t)));e(l)}),1e3)}))},inputValidator(e){return e?{valid:!0,message:""}:{valid:!1,message:"Value required"}},async showInfoModal(){const e={component:"info-modal",props:{header:"header",message:"message",description:"description",details:"details"}};await f.Z.showModal("top",e)},async showCalendarModal(){const e={component:"calendar-modal",props:{currentTimestamp:Date.now()-1e8,selections:{}},listeners:{dayClick(e,t){const{selections:a}=t,{cell:{timestamp:l,selected:i}}=e,n=i?-1:1;a[l]=a[l]||0,a[l]+=n,a[l]<=0&&delete a[l]},monthChanged(e,t){t.targetTimestamp=e.timestamp}}};await f.Z.showModal("middle",e)}}}),w=a(89);const b=(0,w.Z)(y,[["render",h]]);var I=b,C=(0,l.aZ)({name:"HomeView",components:{Test:I}});const k=(0,w.Z)(C,[["render",n]]);var V=k}}]);